# easyRSA

### 思路

读源码

```
p = getPrime(1024)
r = getPrime(1024)
```

说明  r > 1/2 * p   且 r < 2*p

而

```
while True:
    i += 2
    q = 3 * p + i
    if isprime(q):
        break
```

说明 q > 3*p

又因为 n = p*q*r

所以 p^3 <  1/2 * p * 3 * p * p

即 p^3 < 3/2 * p ^ 3 < n

所以 p3 = p^3

而 q3 是否 满足 q3 < n 不可证

但知道 q  与 p 的关系 即可求 q

知道 p q 密文可解

### 脚本

```python
from Crypto.Util.number import *
from gmpy2 import *
from sympy import isprime
c = 2640719266133590657730022832895685409886818590742529130791272703737260220305698395550214267009477025083754511134564208388126840197352795391554568852089628652711333028586269115635454638107282121219105579508186870562401540880966200063720371053375341026415095581071187183255698987802885368019870871700857774915233725950970822696385247250265221054710656258324978454404265263686446369080290837987156460143067938467648544634430526204096794262943836014020497700817110841974583666139237514629813147869957856842689681470713605227842055547284336003555723139181600869545764718106325244640576833841807663070278388715784309402394720118620012282693400066270394787635232774022302892979970665474080486912456524934085857681589946874087460165584042497495882954172855474964204705894262448871106724301335314215246535072952084512124152914188674976352450524342669527245135828009232590386075162445795362903690354959715146165796309514709002988718802
e = 65537
n = 9345250986337993905135661253624938224372287590932847460001525089499733443194408248251827273254448424814772103239241741189673809663273467839088175460048985769805223083749548350679299843313706729420743264951740550553770820288610816152984955433836708023721203222275424126365315358299016330836952095356095354096022623502633502246298604405371548255525331664184283254176009041247292848867813881322374703255343797897302512013574426227476914143434791210650434845757739261087192472695850106563494503574222454074522628470873447356096457607883154105847673523681493074326855248386962151192482197219604675188484844871714861633211306931898637098981455274856566215225103391431004216412586297160781567384462887521038343847921062104100156729686463715597041023610681876583898247828951700335614266599238073859923155027126450971899817712150370526303364315562738310131315219185740569803698983202464094954829450125913356611884405478331969336377719
p3 = 2327266026692360322760969674698375370294458376233643545078379431120356953367044147912180257416216275646087769873941422149785277660435326598255331036543494749808645301940714219569817142190079179959543027926984756934145712691289708494795315507936047432703869914022818494155674095290806214371111448325395696090250361500935559865926381637386499120945772846436340842056725596794979641822941418507859160603754200903295825004190310346064126986524501941476690624751438068501947160311800233342861275773106139171834999148557459880455629984646253550035819111983525952508214255738991482641623384556356128988926170930583597581593542357916953130792318920489256603116937454398574116002342328345773124484327302664760642252393678218510632022453955736767142540750713467435792564693894293556583945453422410146466701318350767746744159566092409573991630191651179437153683072005754458163730344401856565927461665000270194023849945430643901214849693
q3 = 6764676802665765283732213695106505651716650612711290957107094103251237081743742504117903310711148893555737167160967950906159638852113011118364885226380443626002084649901993824309263779249897482383202164318145133899309320933157232441563786111253032540677268344963554584011308423057669802998296532649111670036064378792781659682568070605992433695982516950534380867821876444510920148564754569905291016173987314219005823434489593614944166955465451637367001512017826797662259270552645935262942113352111722937677610817051347164949754069430563810821424981664360332562092374801780827092006697543726579725480361827971086028975502280358001534116066710345923016523305450451840512447626468872227866481031618027036816517253993101077437368542721050129362393142660020816635807528966389873434610565738055828844834282412198385725582966810225405421923441183968095603048157458865613487206808516540333526043275745518980482346726110904804155875607

p=iroot(p3,3)[0]
i=0
while True:
    i+=2
    q = 3*p+i
    if isprime(q):
        break

r=n//(p*q)

phi=(p-1)*(q-1)*(r-1)

d=invert(e,phi)  #求模逆  ed ≡ 1 (mod phi)) invert(e,phi)

m=pow(c,d,n)   # m = c^d % n
flag=long_to_bytes(m)
print(flag)
```

### flag

```
jnctf{now_you_know_rsa}
```